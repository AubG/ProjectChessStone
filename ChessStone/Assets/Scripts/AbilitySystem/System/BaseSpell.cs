using UnityEngine;
using System.Collections.Generic;

[System.Serializable]
public class BaseSpell
{
	#region Interaction Structures
		
		
	public enum CastType
	{
		/// <summary>
		/// The spell is passive.
		/// </summary>
		Passive,

		/// <summary>
		/// The spell does not require a target and is cast instantly.
		/// </summary>
		Instant,

		/// <summary>
		/// The spell requires a target.
		/// </summary>
		Target
	}

	[System.Serializable]
	public class TargetingData {
		public bool canTargetCharacters = false;
	}
		
		
	#endregion
		
	#region Data
		
		
	/// <summary>
	/// 16-bit item ID, generated by the system.
	/// Not to be confused with a 32-bit item ID, which actually contains the ID of the database as its prefix.
	/// </summary>
	public int id16;
	
	/// <summary>
	/// Name of this item.
	/// </summary>
	public string name;
	
	/// <summary>
	/// This item's custom description.
	/// </summary>
	public string description;

	/// <summary>
	/// The type of casting used for the spell.
	/// </summary>
	public CastType castType = CastType.Passive;
	
	/// <summary>
	/// The range of the spell in terms of tiles.
	/// </summary>
	public int tileRange;

	/// <summary>
	/// The spell's viable targets data.
	/// </summary>
	public TargetingData targetingData;

	/// <summary>
	/// A list of ability effects; what happens when the spell is cast.
	/// </summary>
	public List<AbilityEffect> abilityEffects = new List<AbilityEffect>();
	
	/// <summary>
	/// Atlas used for the item's icon.
	/// </summary>
	
	public UIAtlas iconAtlas;
	
	/// <summary>
	/// Name of the icon's sprite within the atlas.
	/// </summary>
	
	public string iconName = "";
	
	
	#endregion
		
	#region Public Interaction


	public AbilityEffect GetEffect<T>() where T : AbilityEffect, new() {
		for(int i = 0, il = abilityEffects.Count; i < il; ++i) {
			if(abilityEffects[i] is T)
				return abilityEffects[i];
		}
		
		return null;
	}
	
	public void AddEffect<T>() where T : AbilityEffect, new() {
		T newEffect = new T();
		abilityEffects.Add(newEffect);
	}


	#endregion
}